多端大模型统一平台
概要设计说明书




项目名称      多端大模型统一平台  

提出者      《软件工程》课程小组  

开发者          黄飞扬、谷强  

用户             在校大学生  

完成日期       2025年11月15日  

组别            G10组  





当前版本（具体更改见文档末版本控制页）：V1.1

目录页
目录
1 引言	3
1.1 编写目的	3
1.2 背景	3
1.3 定义	3
1.4 参考资料	3
2 总体设计	4
2.1 需求规定	4
2.2 运行环境	4
2.3 基本设计概念和处理流程	5
2.4 结构	5
2.5 功能需求与程序的关系	6
2.6 人工处理过程	7
2.7 尚未解决的问题	7
3 接口设计	7
3.1 用户接口	7
3.2 外部接口	8
3.3 内部接口	8
4 运行设计	9
4.1 运行模块组合	9
4.2 运行控制	9
4.3 运行时间	10
5 系统数据结构设计	10
5.1 逻辑结构设计要点	10
5.2 物理结构设计要点	11
5.3 数据结构与程序的关系	11
6 系统出错处理设计	12
6.1 出错信息	12
6.2 补救措施	12
6.3 系统维护设计	13
附件	14

 
概要设计说明书

1 引言
1.1 编写目的
本文档旨在明确 “多端大模型统一平台” 的总体架构设计、模块划分、接口定义和数据结构，为后续的详细设计、编码实现和系统测试提供技术指导。预期的读者包括项目开发团队成员、测试人员及项目评审相关人员。
1.2 背景
a. 待开发软件系统名称：多端大模型统一平台
b. 项目相关方：
1.	任务提出者：《软件工程》课程小组
2.	开发者：黄飞扬（后端）、谷强（前端）
3.	用户：在校大学生
4.	运行环境：云服务器（学生优惠主机）
1.3 定义
1.	大模型：大型语言模型，如 GPT、文心一言、DeepSeek 等
2.	API：应用程序编程接口
3.	统一平台：集成多个大模型服务并提供一致用户体验的 Web 应用
4.	FastAPI：现代、快速（高性能）的 Python Web 框架
1.4 参考资料
[1] 	《GB8567-88 计算机软件产品开发文件编制指南》
[2] 本项目《软件需求规格说明书》V1.2
[3] 本项目《可行性分析报告》V1.1
[4] 本项目《项目开发计划》V1.2
[5] FastAPI 官方文档
[6] Vue 3 官方文档
2 总体设计
2.1 需求规定
主要输入项目：
1.	用户注册信息（用户名、密码）
2.	用户登录凭证
3.	DeepSeek API 配置信息
4.	自然语言问题文本
5.	模型选择参数
主要输出项目：
1.	用户认证状态
2.	大模型生成的回答
3.	历史对话记录列表
4.	系统操作状态提示
处理功能要求：
1.	用户身份认证与会话管理
2.	多模型 API 路由与适配
3.	对话历史持久化存储
4.	敏感内容过滤与审核
性能要求：
	页面响应时间≤3 秒
	数据库操作≤1 秒
	支持 50 + 用户并行操作
2.2 运行环境
硬件环境：
1.	云服务器：1 核 CPU，2GB 内存，50GB SSD
2.	网络带宽：≥5Mbps
软件环境：
	操作系统：Ubuntu 20.04 LTS等linux系统 以及 Windows10/11系统
	Web 服务器：Nginx
	后端运行时：Python 3.8+，FastAPI
	数据库：MySQL 8.0
	前端环境：现代浏览器（Chrome 90+，Firefox 88+，Safari 14+）
2.3 基本设计概念和处理流程
 核心处理流程：
1.	用户通过 Web 界面发起请求
2.	前端 Vue 组件收集数据并调用后端 API
3.	FastAPI 处理业务逻辑、数据验证
4.	数据库操作（用户管理、对话存储）
5.	第三方 API 调用（模型对话）
6.	响应返回并渲染到前端界面
2.4 结构
系统层次结构与模块结构图：

 

系统层次结构
 
模块结构图hipo
2.5 功能需求与程序的关系

功能需求	前端程序	后端用户模块	后端对话模块	后端管理模块	数据库服务
用户注册	√	√			√
用户登录	√	√			√
DeepSeek 配置	√	√			√
模型对话	√		√		√
查看历史	√		√		√
删除记录	√		√		√
用户管理	√			√	√
内容审核	√			√	√
系统监控	√			√	√
2.6 人工处理过程
1.	系统初始化时的管理员账户创建
2.	API 密钥的初始配置与更新
3.	系统备份与恢复操作
4.	敏感词库的手动维护与更新
2.7 尚未解决的问题
1.	第三方 API 调用频率限制的具体处理策略
2.	大文件上传和存储的优化方案
3.	系统水平扩展的具体实施方案
4.	实时通信（WebSocket）的引入时机
3 接口设计
3.1 用户接口
Web 界面规范：
	采用响应式设计，支持 PC 和移动端
	统一采用浅色主题，符合学术使用场景
	主要交互元素：按钮、输入框、下拉选择、对话气泡
主要页面接口：
	登录页面：用户名 / 密码输入表单
	主聊天界面：消息输入框、模型选择器、对话历史侧边栏
	用户设置页面：API 密钥配置表单
	管理后台：数据仪表盘、用户管理表格
3.2 外部接口
第三方 API 接口：

# OpenAI API适配接口
POST /v1/chat/completions
Headers: {"Authorization": "Bearer {api_key}"}
# 文心一言API适配接口  
POST /rpc/2.0/ai_custom/v1/wenxinworkshop/chat/completions
Headers: {"Authorization": "Bearer {api_key}"}
# DeepSeek API适配接口
POST /chat/completions
Headers: {"Authorization": "Bearer {api_key}"}
数据库接口：
	MySQL 8.0 JDBC 连接
	连接池配置：最大连接数 20，最小空闲连接 5
	事务管理：基于 FastAPI 的依赖注入
3.3 内部接口
模块间接口定义：

# 用户服务接口
class UserService:
    def register_user(username: str, password: str) -> User
    def authenticate_user(username: str, password: str) -> Session
    def update_user_settings(user_id: int, settings: Dict) -> bool
# 对话服务接口  
class ConversationService:
    def create_conversation(user_id: int, model: str) -> Conversation
    def send_message(conversation_id: int, content: str) -> Message
    def get_user_conversations(user_id: int) -> List[Conversation]
# 模型路由接口
class ModelRouter:
    def route_to_model(model: str, message: str, api_key: str) -> str
    def handle_api_error(model: str, error: Exception) -> str
4 运行设计
4.1 运行模块组合
正常运行模式：
1.	Web 服务器模块（Nginx）
2.	应用服务器模块（FastAPI + Uvicorn）
3.	数据库服务模块（MySQL 8.0）
4.	前端静态资源服务
管理维护模式：
1.	数据库备份模块
2.	日志分析模块
3.	系统监控模块
4.2 运行控制
启动流程：
1.	启动 MySQL 数据库服务
2.	启动 FastAPI 应用服务器
3.	启动 Nginx Web 服务器
4.	验证各服务健康状态
运行时控制：
1.	通过 systemd 服务管理应用进程
2.	使用 Nginx 进行负载均衡和静态资源缓存
3.	基于 PM2 的进程守护（可选）
4.3 运行时间
1.	数据库服务：24 小时持续运行
2.	应用服务器：根据访问量动态调整资源
3.	预计日均活跃时间：8:00-24:00（16 小时）
5 系统数据结构设计
5.1 逻辑结构设计要点
核心数据实体：
1.	用户（User）
i.	user_id: INT (主键)
ii.	username: VARCHAR(255)
iii.	password_hash: VARCHAR(255)
iv.	email: VARCHAR(255)
v.	created_at: DATETIME
vi.	is_active: BOOLEAN
 
2.	对话（Conversation）
i.	conversation_id: INT (主键)
ii.	user_id: INT (外键)
iii.	title: VARCHAR(200)
iv.	model_used: VARCHAR(50)
v.	created_at: DATETIME
 
3.	消息（Message）
i.	message_id: INT (主键)
ii.	conversation_id: INT (外键)
iii.	role: ENUM('user', 'assistant')
iv.	content: TEXT
v.	created_at: DATETIME
 
4.	系统模型配置（SystemModel）
i.	model_id: INT (主键)
ii.	model_name: VARCHAR(50)
iii.	api_endpoint: VARCHAR(255)
iv.	is_available: BOOLEAN
v.	rate_limit: INT
 
Er图：
 
5.2 物理结构设计要点
存储要求：
	用户表：预计 1MB 存储空间，密码使用哈希存储
	对话表：采用分表策略，每月一个表
	消息表：文本压缩存储，预计 1GB 初始空间
访问方法：
	主键访问：通过 B + 树索引
	用户对话查询：复合索引 (user_id, created_at)
	全文搜索：对消息内容建立全文索引（可选）
保密条件：
	密码字段：哈希加密存储
	API 密钥：AES加密存储
	敏感操作：审计日志记录
5.3 数据结构与程序的关系
	用户管理模块：操作用户表、会话表
	对话服务模块：操作对话表、消息表
	系统管理模块：操作系统配置表、日志表
	模型路由模块：读取系统模型配置表
6 系统出错处理设计
6.1 出错信息

错误类型	错误代码	输出信息	处理方式
数据库连接失败	DB_001	"系统维护中，请稍后重试"	自动重试 3 次，记录告警
API 服务不可用	API_001	"模型服务暂时不可用"	切换备用模型，记录错误
用户认证失败	AUTH_001	"用户名或密码错误"	提示用户重新输入
权限不足	AUTH_002	"无权访问该资源"	跳转到登录页面
请求超时	NET_001	"请求超时，请检查网络"	前端自动重试机制
6.2 补救措施
a. 后备技术
	数据库每日自动备份到云存储
	关键配置文件版本化管理
	系统镜像定期快照
b. 降效技术
	API 服务降级：主模型不可用时自动切换备用模型
	功能降级：对话历史暂时不可用时仍支持基础对话
	缓存策略：常用数据 Redis 缓存，数据库压力大时依赖缓存（可选）
c. 恢复及再启动技术
	服务监控：关键服务异常时自动重启
	数据恢复：基于时间点的数据库恢复
	渐进式恢复：核心功能优先恢复
6.3 系统维护设计
检测点设计：
	数据库连接健康检查（每5分钟）
	API 服务可用性检查（每 5 分钟）
	系统资源监控（CPU、内存、磁盘）
专用维护模块：
	数据库迁移工具（Alembic）
	日志轮转和清理脚本
	性能监控和数据统计接口
维护接口：

# 系统健康检查接口
GET /api/health
# 数据库统计信息
GET /api/admin/database-stats
# 缓存清理接口
POST /api/admin/clear-cache

















附页
附件
HIPO图
 
模块结构图
 



事务流图
 











版本控制页
当前版本：V1.1
历史版本：
版本号	修订日期	修订内容概述	修订人
V1.0	2025-11-20	初稿创建，定义文档基本结构。	黄飞扬
V1.1	2025-11-22	将附件里的内容改到正文中，更改了数据库设计里的内容，让其变得更加详细。	黄飞扬，谷强
	2	 	
		 
	


































